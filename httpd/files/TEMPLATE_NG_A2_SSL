#####
#
server {
    include         /etc/nginx/include.d/listen.conf;
    server_name     [DOMAIN]
                    www.[DOMAIN];

    # Log files
    access_log      [BASEDIR]/[USER]/log/[SUBDOMAIN]nginx-access.log combined buffer=128k;
    error_log       [BASEDIR]/[USER]/log/[SUBDOMAIN]nginx-error.log;
    
    return          301 https://[DOMAIN]$request_uri;
}

server {
    include         /etc/nginx/include.d/listen_ssl.conf;
    server_name     [DOMAIN];

    # Load configuration files for the default server block.
    include         /etc/nginx/default.d/*.conf;
    # Log files
    access_log      [BASEDIR]/[USER]/log/[SUBDOMAIN]nginx-access.log combined buffer=128k;
    error_log       [BASEDIR]/[USER]/log/[SUBDOMAIN]nginx-error.log;
    
    ssl_certificate         /etc/pki/tls/certs/[DOMAIN].crt;
    ssl_certificate_key     /etc/pki/tls/private/[DOMAIN].key;
    include                 /etc/nginx/include.d/ssl_common.conf;

    location ~* \.(jpg|jpeg|gif|png|css|eot|woff|svg|ttf|js|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|tar|wav|bmp|rtf|swf|ico|flv|txt|docx|xlsx)$ {
        root                [BASEDIR]/[USER]/[WEBROOT];
        index               index.html index.php;
        expires             30d;
    }

    location ~ /\.ht {
        deny                all;
    }

    location / {
        proxy_pass          http://127.0.0.1:8888;
        include             /etc/nginx/include.d/proxy_common.conf;
    }
}

server {
    include         /etc/nginx/include.d/listen_ssl.conf;
    server_name     www.[DOMAIN];

    # Log files
    access_log      [BASEDIR]/[USER]/log/[SUBDOMAIN]nginx-access.log combined buffer=128k;
    error_log       [BASEDIR]/[USER]/log/[SUBDOMAIN]nginx-error.log;
    
    ssl_certificate         /etc/pki/tls/certs/[DOMAIN].crt;
    ssl_certificate_key     /etc/pki/tls/private/[DOMAIN].key;
    include                 /etc/nginx/include.d/ssl_common.conf;

    return          301 https://[DOMAIN]$request_uri;
}
