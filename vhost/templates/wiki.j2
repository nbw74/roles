# THIS FILE IS MANAGED BY ANSIBLE, ALL CHANGES WILL BE LOST
# vim: ft=textile:
# =================================== CUT ===================================

h3. Web

*URI:* http://{{ item[0].name }}
{% if item[0].mobile|d() %}
*URI (mob):* http://m.{{ item[0].name }}
{% endif %}
*Software versions:* @{{ vhost_nginx_version }}, {{ vhost_php_version }}{% if vhost_backend == 'apache' %}, {{ vhost_apache_version }}{% endif %}@

h3. SSH Access

*Host:* @{{ ansible_fqdn }}@
*User:* @{{ item[1].name }}@
{%- raw %}
*Private Key:* {{collapse
<pre>
{% endraw %}
{{ lookup('file', '/tmp/vhost_' + item[1].name + '_' + item[1].ssh_key_file|basename) }}
{%- raw %}
</pre>
}}
{% endraw %}

{% if item[0].db is defined %}
h3. Database

*DBMS:* @{{ item[0].db.type }}@
*DB host:* @{{ item[0].db.bouncer|d(item[0].db.host) }}@
{% if item[0].db.type == 'mysql' %}
*DB port:* @{{ item[0].db.port|d('3306') }}@
{% elif item[0].db.type == 'postgresql' %}
{% if item[0].db.bouncer is defined %}
*DB port:* @6432@
{% else %}
*DB port:* @5432@
{% endif %}
{% endif %}
*DB name:* @{{ item[0].db.name }}@
*DB user:* @{{ item[0].db.name }}:{{ item[0].db.pass }}@
{% endif %}

# =================================== CUT ===================================
